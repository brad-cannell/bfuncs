<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Brad Cannell" />


<title>Presenting and Disseminating Results</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Presenting and Disseminating Results</h1>
<h4 class="author"><em>Brad Cannell</em></h4>
<h4 class="date"><em>Created: 2017-11-28 <br> Updated: 2017-11-28</em></h4>



<p>Table of contents:</p>
<p><a href="#stat-tables">Creating tables of summary statistics</a></p>
<hr />
<p>The immediate results of statistical analyses are rarely fit for general consumption. This vignette walks through strategies and functions I’ve created to help make my results ready for presentation/dissemination.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(bfuncs)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(mtcars)</code></pre></div>
<hr />
<div id="stat-tables" class="section level1">
<h1>Creating tables of summary statistics</h1>
<p>Tables are one of the most popular ways to present information to your audience for a reason. When your goal is to show your readers precise numerical summaries of your data, the exact values that resulted from your analysis are important.</p>
<p>However, the specific details that you may want to present from table to table, or the way in which you want to present them, can vary widely. For example, an initial table of descriptive information about your data may or may not include important subgroups of interest, it may include variables of different types, and for any given type, it may include various different kinds of numerical summaries. Additionally, there are numerous types of inferential models that result in numerical summaries that you may want to present in a table. For these reasons, it is difficult to create a good one-size-fits-all approach to automating the process of making results ready for presentation and dissemination.</p>
<p>Having said that, below I walk through the basic strategy I’ve developed over time for moving closer to automating the processes of putting my results into presentation-ready summary tables.</p>
<p>In general, the flow goes something like this:</p>
<ol style="list-style-type: decimal">
<li><p>Start with a .Rmd file whose output is a word document</p></li>
<li><p>Create a table shell</p></li>
<li><p>Calculate the statistics of interest</p></li>
<li><p>Format the statistics of interest for presentation</p></li>
<li><p>Fill in the table shell</p></li>
<li><p>Polish up the resulting Word document</p></li>
</ol>
<p>I’ll walk through each step below…</p>
<div id="start-with-a-.rmd-file-whose-output-is-a-word-document" class="section level2">
<h2>Start with a .Rmd file whose output is a Word document</h2>
<p>Create a new R markdown document. Set the output format to “Word”. Edit the YAML header should look something like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="op">---</span>
title<span class="op">:</span><span class="st"> &quot;Table 1. Descriptive Characteristics&quot;</span>
output<span class="op">:</span>
<span class="st">  </span>word_document<span class="op">:</span>
<span class="st">    </span>reference_docx<span class="op">:</span><span class="st"> </span>word_style_template_<span class="fl">01.</span>docx
<span class="op">---</span></code></pre></div>
<p>This file should only be used to create this one specific table, and most of the code chunks should have the echo=FALSE option set. In other words, the file should only create a single table, and the only code chunk that creates a result that viewable in the output Word document should be the final code chunk that prints your filled-in table shell.</p>
<p>Finally, to limit the amount of polishing you need to do later in the process, you can reference a Word template document in the YAML header, as I’ve done above. More information about the Word templates is available here:</p>
<p><a href="http://rmarkdown.rstudio.com/articles_docx.html" class="uri">http://rmarkdown.rstudio.com/articles_docx.html</a></p>
</div>
<div id="create-a-table-shell" class="section level2">
<h2>Create a table shell</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">table &lt;-<span class="st"> </span><span class="kw">tibble</span>(
  <span class="dt">variable =</span> <span class="st">&quot;&quot;</span>, <span class="co"># Variable names</span>
  <span class="dt">class    =</span> <span class="st">&quot;&quot;</span>, <span class="co"># Classes for categorical variables</span>
  <span class="dt">am_0     =</span> <span class="st">&quot;&quot;</span>, <span class="co"># Group 1</span>
  <span class="dt">am_1     =</span> <span class="st">&quot;&quot;</span>  <span class="co"># Group 2</span>
)</code></pre></div>
<ul>
<li><p>Of course, you can add more groups (or fewer groups) as needed.</p></li>
<li><p>I find it’s best to keep the column names easy to work with at this point. We will make them more presentation ready later on.</p></li>
</ul>
</div>
<div id="calculate-the-statistics-of-interest" class="section level2">
<h2>Calculate the statistics of interest</h2>
<p>This part may vary quite a bit from table to table. However, every descriptive table should include group sample sizes. The <code>get_grou_n</code> is helpful for calculating the group sample size, and returning it in a presentation-ready format.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Same as above, add n's to table</span>
table &lt;-<span class="st"> </span><span class="kw">tibble</span>(
  <span class="dt">variable =</span> <span class="st">&quot;&quot;</span>,
  <span class="dt">class    =</span> <span class="st">&quot;&quot;</span>,
  <span class="dt">am_0     =</span> mtcars <span class="op">%&gt;%</span><span class="st"> </span>bfuncs<span class="op">::</span><span class="kw">get_group_n</span>(am <span class="op">==</span><span class="st"> </span><span class="dv">0</span>),
  <span class="dt">am_1     =</span> mtcars <span class="op">%&gt;%</span><span class="st"> </span>bfuncs<span class="op">::</span><span class="kw">get_group_n</span>(am <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)
)</code></pre></div>
<div id="calculating-and-formatting-descriptive-statistics-for-continuous-variables" class="section level3">
<h3>Calculating and formatting descriptive statistics for continuous variables</h3>
<p>The descriptive analysis vignette gives examples for calculating common descriptive statistics for continuous variables. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(am) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mean_table</span>(mpg)</code></pre></div>
<pre><code>## # A tibble: 2 x 6
##      am   var     n  mean   lcl   ucl
##   &lt;dbl&gt; &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     0   mpg    19 17.15 15.30 19.00
## 2     1   mpg    13 24.39 20.67 28.12</code></pre>
<p>Although the statistics we need are there, they aren’t in a form that can easily be put into a Word table. To help with that process, I’ve created the <code>format_table</code> function.</p>
<p>The <code>format_table</code> function is an S3 generic. It currently has methods for formatting the output of the <code>freq_table</code> and <code>mean_table</code> functions. Examples of how to use of <code>format_table</code> will be give here and below.</p>
<div id="example-mean-and-95-confidence-interval-the-default-overall" class="section level4">
<h4>Example: mean and 95% confidence interval (the default) overall</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mean_table</span>(mpg) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">format_table</span>()</code></pre></div>
<pre><code>## # A tibble: 1 x 2
##     var               mean_95
##   &lt;chr&gt;                 &lt;chr&gt;
## 1   mpg 20.09 (17.92 - 22.26)</code></pre>
<ul>
<li>Note: Changing the digits argument to <code>format_table</code> will change the number of digits displayed, but does not change the underlying rounding of the value. That must be changed in the digits argument to <code>mean_table</code>.</li>
</ul>
</div>
<div id="example-n-and-mean-overall" class="section level4">
<h4>Example: n and mean overall</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mean_table</span>(mpg) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">format_table</span>(<span class="dt">stats =</span> <span class="st">&quot;n and mean&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 1 x 2
##     var     n_mean
##   &lt;chr&gt;      &lt;chr&gt;
## 1   mpg 32 (20.09)</code></pre>
</div>
<div id="example-mean-and-95-confidence-interval-the-default-by-subgroup" class="section level4">
<h4>Example: mean and 95% confidence interval (the default) by subgroup</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(am) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mean_table</span>(mpg) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">format_table</span>()</code></pre></div>
<pre><code>## # A tibble: 2 x 3
##      am   var               mean_95
##   &lt;dbl&gt; &lt;chr&gt;                 &lt;chr&gt;
## 1     0   mpg 17.15 (15.30 - 19.00)
## 2     1   mpg 24.39 (20.67 - 28.12)</code></pre>
</div>
<div id="example-n-and-mean-by-subgroup" class="section level4">
<h4>Example: n and mean by subgroup</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(am) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mean_table</span>(mpg) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">format_table</span>(<span class="dt">stats =</span> <span class="st">&quot;n and mean&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 2 x 3
##      am   var     n_mean
##   &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;
## 1     0   mpg 19 (17.15)
## 2     1   mpg 13 (24.39)</code></pre>
</div>
</div>
<div id="calculating-and-formatting-descriptive-statistics-for-categorical-variables" class="section level3">
<h3>Calculating and formatting descriptive statistics for categorical variables</h3>
<p>The descriptive analysis vignette gives examples for calculating common descriptive statistics for continuous variables. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(am) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mean_table</span>(mpg)</code></pre></div>
<pre><code>## # A tibble: 2 x 6
##      am   var     n  mean   lcl   ucl
##   &lt;dbl&gt; &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     0   mpg    19 17.15 15.30 19.00
## 2     1   mpg    13 24.39 20.67 28.12</code></pre>
<p><a href="#top">top</a></p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
